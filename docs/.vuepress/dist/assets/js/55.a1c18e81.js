(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{412:function(e,t,a){"use strict";a.r(t);var o=a(42),r=Object(o.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"azure-image-guide"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#azure-image-guide"}},[e._v("#")]),e._v(" Azure Image Guide")]),e._v(" "),a("p",[e._v("This file is a copy of the file "),a("a",{attrs:{href:"https://github.com/enigmampc/SecretNetwork/blob/master/deployment/azure/secret-node-azure-template/Usage.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),a("OutboundLink")],1),e._v(" and is mainly here for visibility.\nThe files you need to run this guide are "),a("a",{attrs:{href:"https://github.com/enigmampc/SecretNetwork/tree/master/deployment/azure/secret-node-azure-template",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),a("OutboundLink")],1)]),e._v(" "),a("h2",{attrs:{id:"requirements"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#requirements"}},[e._v("#")]),e._v(" Requirements")]),e._v(" "),a("ul",[a("li",[e._v("An Azure account (you should be able to use a free-trial account for this)")])]),e._v(" "),a("h2",{attrs:{id:"general-info"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#general-info"}},[e._v("#")]),e._v(" General info")]),e._v(" "),a("p",[e._v("This folder contains templates which are used to create an Azure marketplace offering of a 1-click secret node.\nPossibly in the future we will add more complex architectures, but at the moment it is just a single node.")]),e._v(" "),a("p",[e._v("To make things 1-clicky and simple the node setup and registration is performed automatically, with all you need to do is configure the parameters of your node.")]),e._v(" "),a("p",[e._v("There are 2 variants in this folder - the marketplace template and the quickstart template. The quickstart template is basically a DIY version of the marketplace image which you\ncan customize or deploy yourself via the azure command-line.")]),e._v(" "),a("p",[e._v("Now lets go over how to do that, and how to use the image once it's deployed.")]),e._v(" "),a("h2",{attrs:{id:"installation-quickstart-template"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#installation-quickstart-template"}},[e._v("#")]),e._v(" Installation - Quickstart Template")]),e._v(" "),a("p",[a("strong",[e._v("Note: This image is preconfigured to work with the testnet")])]),e._v(" "),a("p",[e._v("Download this directory.")]),e._v(" "),a("p",[e._v("Using Azure CLI login to enigmampc using")]),e._v(" "),a("p",[a("code",[e._v("az login")])]),e._v(" "),a("p",[e._v("Then, create a resource group for the new secret node")]),e._v(" "),a("p",[a("code",[e._v('az group create --name <resource-group-name> --location "UK South"')])]),e._v(" "),a("p",[e._v("Note: Only UK south, East US and Central Canada are available for SGX machines")]),e._v(" "),a("p",[e._v("Finally, deploy the secret node using:\n"),a("code",[e._v("az deployment group create --resource-group <resource-group-name> --template-file azuredeploy.json")])]),e._v(" "),a("p",[e._v("(or "),a("code",[e._v("az group deployment create --resource-group <resource-group-name> --template-file azuredeploy.json")]),e._v(" on newer az cli versions)")]),e._v(" "),a("p",[e._v("By default the node will try to connect to our testnet node/registration service, so configure the parameters\naccordingly to what you want")]),e._v(" "),a("p",[e._v("Note: When asked to enter a "),a("code",[e._v("adminPasswordOrKey")]),e._v(" You can enter either your SSH public key, or a password. "),a("em",[e._v("However")]),e._v(", only using an SSH key is properly tested. So use a password at your own risk.")]),e._v(" "),a("h2",{attrs:{id:"installation-azure-marketplace"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#installation-azure-marketplace"}},[e._v("#")]),e._v(" Installation - Azure Marketplace")]),e._v(" "),a("p",[a("strong",[e._v("Not available publicly yet. Will update this section once it is released")])]),e._v(" "),a("h2",{attrs:{id:"usage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#usage"}},[e._v("#")]),e._v(" Usage")]),e._v(" "),a("p",[e._v("The actual node runs in a docker image on the machine that is created. However, it will come with some handy aliases to help you use it easily.")]),e._v(" "),a("h3",{attrs:{id:"ssh-into-your-machine"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssh-into-your-machine"}},[e._v("#")]),e._v(" SSH into your machine")]),e._v(" "),a("p",[a("code",[e._v("ssh <adminUsernam>@<vmDnsName>.<group_region>.cloudapp.azure.com")])]),e._v(" "),a("p",[e._v("(you can also find this string in the output of the group deployment command under the key "),a("code",[e._v("sshCommand")]),e._v(")")]),e._v(" "),a("h3",{attrs:{id:"commands"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#commands"}},[e._v("#")]),e._v(" Commands")]),e._v(" "),a("p",[a("code",[e._v("secretd")]),e._v(", "),a("code",[e._v("secretcli")]),e._v(" - will work as you would normally expect")]),e._v(" "),a("p",[a("code",[e._v("show-node-id")]),e._v(" - will print out the p2p address of the node\n"),a("code",[e._v("show-validator")]),e._v(" - will print out the validator consensus public key, which is used when creating a validator")]),e._v(" "),a("p",[a("code",[e._v("stop-secret-node")]),e._v(" - will stop the node\n"),a("code",[e._v("start-secret-node")]),e._v(" - will start the node")]),e._v(" "),a("h3",{attrs:{id:"debugging"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#debugging"}},[e._v("#")]),e._v(" Debugging")]),e._v(" "),a("p",[e._v("After creating the machine a healthy status of the node will have 2 containers active:")]),e._v(" "),a("p",[a("code",[e._v("docker ps")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('CONTAINER ID        IMAGE                                      COMMAND                  CREATED             STATUS                    PORTS                                  NAMES\nbf9ba8dd0802        enigmampc/secret-network-node:pubtestnet   "/bin/bash startup.sh"   13 minutes ago      Up 13 minutes (healthy)   0.0.0.0:26656-26657->26656-26657/tcp   secret-node_node_1\n2405b23aa1bd        enigmampc/aesm                             "/bin/sh -c \'./aesm_â€¦"   13 minutes ago      Up 13 minutes                                                    secret-node_aesm_1\n')])])]),a("p",[e._v("You can see the logs of the node by checking the docker logs of the node container:")]),e._v(" "),a("p",[a("code",[e._v("docker logs secret-node_node_1")])]),e._v(" "),a("p",[e._v("If you want to debug/do other stuff with your node you can exec into the actual node using")]),e._v(" "),a("p",[a("code",[e._v("docker exec -it secret-node_node_1 /bin/bash")])])])}),[],!1,null,null,null);t.default=r.exports}}]);